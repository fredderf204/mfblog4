<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="This simple Gen AI Product Recommendation System is designed for rapid proof-of-concept (POC) development. It leverages generative AI techniques to provide product recommendations to your customers."><meta name=keywords content="Gen AI,Recommendation System,Next Best Product,Azure Open AI,Python,AI,Azure"><title>Part 2 - Simple Gen AI Product Recommendation System</title>
<link rel=canonical href=https://mfblog.au/p/part-2-simple-gen-ai-product-recommendation-system/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Part 2 - Simple Gen AI Product Recommendation System"><meta property='og:description' content="This simple Gen AI Product Recommendation System is designed for rapid proof-of-concept (POC) development. It leverages generative AI techniques to provide product recommendations to your customers."><meta property='og:url' content='https://mfblog.au/p/part-2-simple-gen-ai-product-recommendation-system/'><meta property='og:site_name' content='MF Azure Blog'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Azure Open AI'><meta property='article:tag' content='Python'><meta property='article:published_time' content='2024-09-05T10:49:01+10:00'><meta property='article:modified_time' content='2024-09-05T10:49:01+10:00'><meta property='og:image' content='https://mfblog.au/p/part-2-simple-gen-ai-product-recommendation-system/cover.jpg'><meta name=twitter:title content="Part 2 - Simple Gen AI Product Recommendation System"><meta name=twitter:description content="This simple Gen AI Product Recommendation System is designed for rapid proof-of-concept (POC) development. It leverages generative AI techniques to provide product recommendations to your customers."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://mfblog.au/p/part-2-simple-gen-ai-product-recommendation-system/cover.jpg'><link rel="shortcut icon" href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-C4H16BVKJJ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C4H16BVKJJ")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/me_hu8008747913738786229.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>☁️</span></figure><div class=site-meta><h1 class=site-name><a href=/>MF Azure Blog</a></h1><h2 class=site-description>Short musings found while working with Azure | Opinions are my own</h2></div></header><ol class=menu-social><li><a href=https://github.com/fredderf204 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/1michaelfriedrich/ target=_blank title=Linkedin rel=me><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li><li><a href=https://twitter.com/fredderf204 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#tldr>TLDR</a></li><li><a href=#pre-requisites>Pre-requisites</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#02-prepcsvpy>02-prepcsv.py</a></li><li><a href=#02-csvipynb>02-csv.ipynb</a></li><li><a href=#setup-python-environment>Setup Python environment</a></li><li><a href=#upload-the-json-file-to-azure-blob-storage>Upload the JSON file to Azure Blob Storage</a></li><li><a href=#create-a-blob-data-source-connector-on-azure-ai-search>Create a blob data source connector on Azure AI Search</a></li><li><a href=#create-a-search-index-on-azure-ai-search>Create a search index on Azure AI Search</a></li><li><a href=#create-an-skillset-on-azure-ai-search>Create an skillset on Azure AI Search</a></li><li><a href=#create-an-indexer-on-azure-ai-search>Create an indexer on Azure AI Search</a></li><li><a href=#query-the-index>Query the index</a></li><li><a href=#make-recommendations-using-azure-open-ai>Make recommendations using Azure Open AI</a></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/part-2-simple-gen-ai-product-recommendation-system/><img src=/p/part-2-simple-gen-ai-product-recommendation-system/cover_hu6796165582073554171.jpg srcset="/p/part-2-simple-gen-ai-product-recommendation-system/cover_hu6796165582073554171.jpg 800w, /p/part-2-simple-gen-ai-product-recommendation-system/cover_hu13874716264497271705.jpg 1600w" width=800 height=800 loading=lazy alt="Featured image of post Part 2 - Simple Gen AI Product Recommendation System"></a></div><div class=article-details><header class=article-category><a href=/categories/azure/>Azure
</a><a href=/categories/ai/>AI
</a><a href=/categories/python/>Python</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/part-2-simple-gen-ai-product-recommendation-system/>Part 2 - Simple Gen AI Product Recommendation System</a></h2><h3 class=article-subtitle>This simple Gen AI Product Recommendation System is designed for rapid proof-of-concept (POC) development. It leverages generative AI techniques to provide product recommendations to your customers.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 05, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>30 minute read</time></div></footer></div></header><section class=article-content><blockquote><p>I am a Microsoft employee, but the views expressed here are mine and not those of my employer.</p></blockquote><p>This is part 2 of an ongoing series on simple Gen AI Product Recommendation System that you can POC quickly. If you missed the first post in the series, you can find it <a class=link href=https://mfblog.au/p/simple-gen-ai-product-recommendation-system-you-can-poc-quickly/ target=_blank rel=noopener>here</a>.</p><p>In this post, we will expand our simple Gen AI Product Recommendation System by increasing our data set and using cloud services to scale our solution. Lastly we will be using some more advanced prompt engineering techniques to improve the quality of our recommendations.</p><p>But&mldr;&mldr; why would you want to do this??? once you have completed this walk through, you will have a vector store setup in Azure and the ability to experiment with different searching techniques. As well as Azure Open AI setup to experiment with different prompt engineering techniques to get the best results for you project.</p><h2 id=tldr>TLDR</h2><p>If you just want to see the code, you can find it <a class=link href=https://github.com/fredderf204/poc-recsys target=_blank rel=noopener>here</a></p><p>If you want to skip to the good stuff at the end of this blog post, you can find it searching techniques <a class=link href=#query-the-index>here</a> and prompt engineering techniques <a class=link href=#make-recommendations-using-azure-open-ai>here</a>.</p><p>All you need is a CSV file or JSON file with customer and product performance data to use this sample. A sample CSV file has been included in the GitHub repo if you just want to run through the process.</p><h2 id=pre-requisites>Pre-requisites</h2><p>To follow along with this post, you will need the following already running in Azure:</p><ol><li><p>Azure Open AI. I use the <em>text-embedding-3-large</em> model to vectorise the CSV or JSON file (more details on this later) and the question. I also use the <em>GPT-4o</em> model to recommend the next best product to the customer. You can sign up for Azure Open AI <a class=link href=https://azure.microsoft.com/en-us/services/cognitive-services/openai/ target=_blank rel=noopener>here</a></p></li><li><p>Azure AI Search. I use Azure AI Search for various things in the sample, but mainly to index the JSON file, store the embeddings and search for similar customer profiles (more details on this later). You can sign up for Azure AI Search <a class=link href=https://azure.microsoft.com/en-us/services/search/ target=_blank rel=noopener>here</a>.</p></li><li><p>Azure Blob Storage. I use Azure Blob Storage to store the CSV or JSON file.</p></li></ol><h2 id=introduction>Introduction</h2><p>In the first post, we built a simple Gen AI Product Recommendation System that used a small dataset to provide product recommendations to customers. We used a generative AI model to generate recommendations based on the customer&rsquo;s product performance. In this post, we will expand our dataset and use cloud services to scale our solution. We will also use some more advanced prompt engineering techniques to improve the quality of our recommendations.</p><p>The has 2 files that you need to follow in order;</p><ol><li><a class=link href=#02-prepcsvpy>02-prepcsv.py</a></li><li><a class=link href=#02-csvipynb>02-csv.ipynb</a></li></ol><p>Also I create a larger dataset using a combination of python and Microsoft excel. The dataset is called <em>test-recsys-data-5000.csv</em> and can be found in the <em>data</em> folder. It has 5000 rows of sample data.</p><h2 id=02-prepcsvpy>02-prepcsv.py</h2><p>This scripts does a couple of things to prepare the CSV file for indexing in Azure AI Search.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read the CSV file with specified data types</span>
</span></span><span class=line><span class=cl><span class=n>csv_input</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>(),</span><span class=s1>&#39;./data/test-recsys-data-5000.csv&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>dtype</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;CompanyName&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;State&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Industry&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Segment&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 1 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 1 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 2 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 2 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 3 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 3 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 4 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 4 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 5 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 5 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 6 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 6 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 7 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 7 Performance&#39;</span><span class=p>:</span><span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Product 8 Name&#39;</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=s1>&#39;Product 8 Performance&#39;</span><span class=p>:</span><span class=nb>float</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Lines 1 - 21 read the csv files, create a pandas dataframe and casts the columns to the correct data types.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>csv_input</span><span class=p>[</span><span class=s1>&#39;json&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>csv_input</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>to_json</span><span class=p>(),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Line 24 creates a new column called <em>json</em> and converts the row to a JSON string. The reason I do this is similar to the first post, when I have found the similar customer profiles to my target profile, I can use the JSON string as input to the generative AI model to recommend the next best product.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>performance_columns</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>csv_input</span><span class=o>.</span><span class=n>columns</span> <span class=k>if</span> <span class=s1>&#39;Performance&#39;</span> <span class=ow>in</span> <span class=n>col</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>csv_input</span><span class=p>[</span><span class=s1>&#39;performance&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>csv_input</span><span class=p>[</span><span class=n>performance_columns</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>skipna</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Line 27 and 28 create a new column called <em>performance</em> and calculates the mean of the performance columns. Just like in the first example, I have arbitrary numbers in the performance columns. You might have actual performance data in your dataset and a way of calculating the product portfolio performance of the customer. I simply take the mean of the performance columns to get a single number to represent the customer&rsquo;s product portfolio performance.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cols</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;State&#39;</span><span class=p>,</span><span class=s1>&#39;Industry&#39;</span><span class=p>,</span><span class=s1>&#39;Segment&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>csv_input</span><span class=p>[</span><span class=s1>&#39;prof&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>csv_input</span><span class=p>[</span><span class=n>cols</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>row</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Again as in the first example, I am using the <em>State</em>, <em>Industry</em> and <em>Segment</em> columns to create a profile of the customer. I concatenate the values of these columns to create a single string that represents the customer profile. You might have another way of creating a customer profile or have more data points to create the customer profile, but this is a simple way to do it.</p><blockquote><p>The customer profile is important as is what&rsquo;s used to find similar customer profiles in the dataset. The more accurate the customer profile, the more chance of finding similar customer profiles.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>csv_input</span><span class=o>.</span><span class=n>to_json</span><span class=p>(</span><span class=s1>&#39;02/data/output1.json&#39;</span><span class=p>,</span> <span class=n>orient</span><span class=o>=</span><span class=s1>&#39;records&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Finally I saved the dataframe to a JSON file. This is the file that will be uploaded to Azure Blob Storage and indexed in Azure AI Search. The reason I chose JSON is that it&rsquo;s easier to work with in Azure AI Search. So if you have started with JSON, you will just need to create a dataframe from that JSOn and start at line 24.</p><h2 id=02-csvipynb>02-csv.ipynb</h2><p>I have used an existing sample created my Microsoft and tweaked it for our needs. You can find the original sample <a class=link href=https://github.com/Azure/azure-search-vector-samples/blob/main/demo-python/code/indexers/csv.ipynb target=_blank rel=noopener>here</a>. The code flows as follows;</p><ol><li>Setup Python environment</li><li>Upload the JSON file to Azure Blob Storage</li><li>Create a blob data source connector on Azure AI Search</li><li>Create a search index on Azure AI Search</li><li>Create an skillset on Azure AI Search</li><li>Create an indexer on Azure AI Search</li><li>Query the index</li><li>Make recommendations using Azure Open AI</li></ol><p>I have added some additional code to the sample to make it easier to follow. The code is well commented and should be easy to follow.</p><h2 id=setup-python-environment>Setup Python environment</h2><p>If you are not new to Python, this setup should be familiar to you. If you are new to Python, the notebook as some good detail on how to setup your Python environment using VS Code.</p><p>I can be a little tricky to figure out which environment variables to use and add to your .env file. So I have listed the ones that i used; AZURE_SEARCH_SERVICE_ENDPOINT, AZURE_SEARCH_ADMIN_KEY, AZURE_SEARCH_INDEX, BLOB_CONNECTION_STRING, BLOB_CONTAINER_NAME, AZURE_OPENAI_ENDPOINT, AZURE_OPENAI_KEY, AZURE_OPENAI_EMBEDDING_DEPLOYMENT, AZURE_OPENAI_EMBEDDING_MODEL_NAME, AZURE_OPENAI_EMBEDDING_DIMENSIONS, AZURE_OPENAI_CHATGPT_DEPLOYMENT and AZURE_OPENAI_API_VERSION.</p><h2 id=upload-the-json-file-to-azure-blob-storage>Upload the JSON file to Azure Blob Storage</h2><p>This part of the notebook is pretty straight forward. If you have run through the 02-prepcsv.py script, you should have a JSON file called <em>output1.json</em> in the <em>data</em> folder. This code will take that file and upload it to Azure Blob Storage using the connection string and blob container name you have in your environment variables.</p><h2 id=create-a-blob-data-source-connector-on-azure-ai-search>Create a blob data source connector on Azure AI Search</h2><p>Again, this part of the notebook is also straight forward. You will need to create a blob data source connector on Azure AI Search. The code will create the connector so it can be used in subsequent steps.</p><h2 id=create-a-search-index-on-azure-ai-search>Create a search index on Azure AI Search</h2><p>OK, now for some more interesting stuff with Azure AI Search.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>index_client</span> <span class=o>=</span> <span class=n>SearchIndexClient</span><span class=p>(</span><span class=n>endpoint</span><span class=o>=</span><span class=n>endpoint</span><span class=p>,</span> <span class=n>credential</span><span class=o>=</span><span class=n>credential</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=n>fields</span> <span class=o>=</span> <span class=p>[</span>  
</span></span><span class=line><span class=cl>    <span class=n>SearchField</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;AzureSearch_DocumentKey&#34;</span><span class=p>,</span>  <span class=n>key</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>String</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>SearchField</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;CompanyName&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>String</span><span class=p>,</span> <span class=n>sortable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>filterable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>facetable</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>SearchField</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;performance&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>Double</span><span class=p>,</span> <span class=n>sortable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>filterable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>facetable</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>    <span class=n>SearchField</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;prof&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>String</span><span class=p>,</span> <span class=n>sortable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>filterable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>facetable</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>    <span class=n>SearchField</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;json&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>String</span><span class=p>,</span> <span class=n>sortable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>filterable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>facetable</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>    <span class=n>SearchField</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;prof_vector&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>Collection</span><span class=p>(</span><span class=n>SearchFieldDataType</span><span class=o>.</span><span class=n>Single</span><span class=p>),</span> <span class=n>vector_search_dimensions</span><span class=o>=</span><span class=n>azure_openai_model_dimensions</span><span class=p>,</span> <span class=n>vector_search_profile_name</span><span class=o>=</span><span class=s2>&#34;myHnswProfile&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>  
</span></span></code></pre></td></tr></table></div></div><p>This code snippet creates a search index client and is the configuration to create the search index. The index has 5 fields, <em>AzureSearch_DocumentKey</em>, <em>CompanyName</em>, <em>performance</em>, <em>prof</em> and <em>json</em>. The <em>AzureSearch_DocumentKey</em> is the unique key for the index and is automatically generated by the indexer. The <em>CompanyName</em> is the name of the company. The <em>performance</em> is the performance of the customer&rsquo;s product portfolio. The <em>prof</em> is the customer profile. The <em>json</em> is the JSON string of the customer&rsquo;s product performance. The <em>prof_vector</em> is the vectorised version of the customer profile.</p><p>Notice that theses fields are the same as the columns in the JSON file. This is important as the indexer will use these fields to index the JSON file.</p><p>Lastly, the <em>prof_vector</em> is something that doesn&rsquo;t exist yet. This will be a vectorised version of the customer profile and will be created by our indexer later in this code. So for now, just know that it will be created and will hold the vectorised version of the customer profile.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Configure the vector search configuration  </span>
</span></span><span class=line><span class=cl><span class=n>vector_search</span> <span class=o>=</span> <span class=n>VectorSearch</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>    <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span>  
</span></span><span class=line><span class=cl>        <span class=n>HnswAlgorithmConfiguration</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;myHnsw&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>  
</span></span><span class=line><span class=cl>    <span class=n>profiles</span><span class=o>=</span><span class=p>[</span>  
</span></span><span class=line><span class=cl>        <span class=n>VectorSearchProfile</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=s2>&#34;myHnswProfile&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>            <span class=n>algorithm_configuration_name</span><span class=o>=</span><span class=s2>&#34;myHnsw&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>            <span class=n>vectorizer</span><span class=o>=</span><span class=s2>&#34;myOpenAI&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>  
</span></span><span class=line><span class=cl>    <span class=n>vectorizers</span><span class=o>=</span><span class=p>[</span>  
</span></span><span class=line><span class=cl>        <span class=n>AzureOpenAIVectorizer</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=s2>&#34;myOpenAI&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>            <span class=n>kind</span><span class=o>=</span><span class=s2>&#34;azureOpenAI&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>            <span class=n>azure_open_ai_parameters</span><span class=o>=</span><span class=n>AzureOpenAIParameters</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>                <span class=n>resource_uri</span><span class=o>=</span><span class=n>azure_openai_endpoint</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>                <span class=n>deployment_id</span><span class=o>=</span><span class=n>azure_openai_embedding_deployment</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>model_name</span><span class=o>=</span><span class=n>azure_openai_model_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>api_key</span><span class=o>=</span><span class=n>azure_openai_key</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>  
</span></span><span class=line><span class=cl>    <span class=p>],</span>  
</span></span><span class=line><span class=cl><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><p>This next part of the code will configure the vector search configuration. I used the default HNSW algorithm and the Azure Open AI vectoriser. If you would like to learn more about the HNSW algorithm, you can find more information <a class=link href=https://learn.microsoft.com/en-us/azure/search/vector-search-overview#nearest-neighbors-search target=_blank rel=noopener>here</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>semantic_config</span> <span class=o>=</span> <span class=n>SemanticConfiguration</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>=</span><span class=s2>&#34;my-semantic-config&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>prioritized_fields</span><span class=o>=</span><span class=n>SemanticPrioritizedFields</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>title_field</span><span class=o>=</span><span class=n>SemanticField</span><span class=p>(</span><span class=n>field_name</span><span class=o>=</span><span class=s2>&#34;CompanyName&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>content_fields</span><span class=o>=</span><span class=p>[</span><span class=n>SemanticField</span><span class=p>(</span><span class=n>field_name</span><span class=o>=</span><span class=s2>&#34;prof&#34;</span><span class=p>)]</span>  
</span></span><span class=line><span class=cl>    <span class=p>),</span>  
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Now this section of the code is where you configure the semantic configuration. The semantic configuration is used to configure semantic ranking. <a class=link href=https://learn.microsoft.com/en-us/azure/search/semantic-how-to-configure target=_blank rel=noopener>Semantic ranking iterates over an initial result set, applying an L2 ranking methodology that promotes the most semantically relevant results to the top of the stack.</a>. I have added this section if some we can play around with semantic ranking later in this code.</p><h2 id=create-an-skillset-on-azure-ai-search>Create an skillset on Azure AI Search</h2><p>This part of the code creates a skillset on Azure AI Search. The skillset is used to create the vectorised version of the customer profile. The skillset uses the Azure Open AI vectoriser to create the vectorised version of the customer profile.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>csv_comb_embedding_skill</span> <span class=o>=</span> <span class=n>AzureOpenAIEmbeddingSkill</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s2>&#34;Skill to generate comb embeddings via Azure OpenAI&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>context</span><span class=o>=</span><span class=s2>&#34;/document&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>resource_uri</span><span class=o>=</span><span class=n>azure_openai_endpoint</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>deployment_id</span><span class=o>=</span><span class=n>azure_openai_embedding_deployment</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>model_name</span><span class=o>=</span><span class=n>azure_openai_model_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dimensions</span><span class=o>=</span><span class=n>azure_openai_model_dimensions</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>api_key</span><span class=o>=</span><span class=n>azure_openai_key</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>inputs</span><span class=o>=</span><span class=p>[</span>  
</span></span><span class=line><span class=cl>        <span class=n>InputFieldMappingEntry</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=n>source</span><span class=o>=</span><span class=s2>&#34;/document/prof&#34;</span><span class=p>),</span>  
</span></span><span class=line><span class=cl>    <span class=p>],</span>  
</span></span><span class=line><span class=cl>    <span class=n>outputs</span><span class=o>=</span><span class=p>[</span>  
</span></span><span class=line><span class=cl>        <span class=n>OutputFieldMappingEntry</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;embedding&#34;</span><span class=p>,</span> <span class=n>target_name</span><span class=o>=</span><span class=s2>&#34;prof_vector&#34;</span><span class=p>),</span>  
</span></span><span class=line><span class=cl>    <span class=p>],</span>  
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>skills</span> <span class=o>=</span> <span class=p>[</span><span class=n>csv_comb_embedding_skill</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>This code snippet above is the configuration for the skillset. The main parts of the configuration to look out for are the <em>context</em> - which is the path to the document in the JSON file. I just left this as the default /document. The <em>inputs</em> - which is the field in the JSON file that will be vectorised. <em>name</em> should be text and <em>source</em> should be /document/prof, as it&rsquo;s the prof field we want vectorised. And lastly, the <em>outputs</em> - which is the field in the search index that will hold the vectorised version of the customer profile. <em>name</em> should be embedding and <em>source</em> should be prof_vector.</p><h2 id=create-an-indexer-on-azure-ai-search>Create an indexer on Azure AI Search</h2><p>The indexer is the part of Azure AI Search that brings together the data source, the search index and the skillset. The indexer will use the data source to index the JSON file, use the skillset to create the vectorised version of the customer profile and use the search index to store the data.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>indexer_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>index_name</span><span class=si>}</span><span class=s2>-indexer&#34;</span>  
</span></span><span class=line><span class=cl><span class=n>indexer_parameters</span> <span class=o>=</span> <span class=n>IndexingParameters</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>configuration</span><span class=o>=</span><span class=n>IndexingParametersConfiguration</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>parsing_mode</span><span class=o>=</span><span class=s1>&#39;jsonArray&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>query_timeout</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>first_line_contains_headers</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>This code snippet above is the configuration for the indexing parameters. The main parts of the configuration to look out for are the <em>parsing_mode</em> - which is the mode the indexer will use to parse the JSON file. I have used jsonArray as the JSON file is an array of JSON objects and this parsing mode will take each JSON object and create a document in the search index. I.e. one JSON file to many documents in the search index.</p><blockquote><p>There are other types of parsing modes out there for Azure AI Search to parse standalone files or embedded objects of various content types in data sources like Azure Blob Storage, Azure Data Lake Storage Gen2, and SharePoint. You can learn about them <a class=link href=https://learn.microsoft.com/en-us/azure/search/search-blob-metadata-properties target=_blank rel=noopener>here</a>.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>indexer</span> <span class=o>=</span> <span class=n>SearchIndexer</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>=</span><span class=n>indexer_name</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s2>&#34;Indexer to index documents and generate embeddings&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>skillset_name</span><span class=o>=</span><span class=n>skillset_name</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>target_index_name</span><span class=o>=</span><span class=n>index_name</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>data_source_name</span><span class=o>=</span><span class=n>data_source</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>parameters</span><span class=o>=</span><span class=n>indexer_parameters</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>field_mappings</span><span class=o>=</span><span class=p>[</span><span class=n>FieldMapping</span><span class=p>(</span><span class=n>source_field_name</span><span class=o>=</span><span class=s2>&#34;AzureSearch_DocumentKey&#34;</span><span class=p>,</span> <span class=n>target_field_name</span><span class=o>=</span><span class=s2>&#34;AzureSearch_DocumentKey&#34;</span><span class=p>,</span> <span class=n>mapping_function</span><span class=o>=</span><span class=n>FieldMappingFunction</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;base64Encode&#34;</span><span class=p>))],</span>
</span></span><span class=line><span class=cl>    <span class=n>output_field_mappings</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>FieldMapping</span><span class=p>(</span><span class=n>source_field_name</span><span class=o>=</span><span class=s2>&#34;/document/prof_vector&#34;</span><span class=p>,</span> <span class=n>target_field_name</span><span class=o>=</span><span class=s2>&#34;prof_vector&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  
</span></span></code></pre></td></tr></table></div></div><p>Now for the search indexer parameters configuration, which is above. This is the part that ties together the data source, the search index and the skillset. The main parts of the configuration to look out for are the <em>skillset_name</em> - which is the name of the skillset that will be used to create the vectorised version of the customer profile. The <em>target_index_name</em> - which is the name of the search index that will store the data. The <em>data_source_name</em> - which is the name of the data source that will be used to index the JSON file. The <em>field_mappings</em> - which is the field mapping that will be used to map the system created <em>AzureSearch_DocumentKey</em> field to the <em>AzureSearch_DocumentKey</em> field in the search index. The <em>output_field_mappings</em> - which is the field mapping that will be used to map the <em>prof_vector</em> field in the JSON file to the <em>prof_vector</em> field in the search index.</p><h2 id=query-the-index>Query the index</h2><p>Now we can have some fun!</p><p>There are different types of queries you can run on the search index which fall in the retrieval bucket, which you can read about <a class=link href=https://learn.microsoft.com/en-us/azure/search/search-query-overview#types-of-queries target=_blank rel=noopener>here</a>. The good news is that we are setup to try out full text search, vector search and hybrid search. Also we are setup to try out semantic ranking.</p><p>There is a good blog post <a class=link href=https://techcommunity.microsoft.com/t5/ai-azure-ai-services-blog/azure-ai-search-outperforming-vector-search-with-hybrid/ba-p/3929167 target=_blank rel=noopener>here</a> which goes into more details about all of this.</p><p>But the purpose of the next part of the notebook is to return the top 20 similar customer profiles to the target customer profile. I have picked 20 for no particular reason, but feel free to try out some different numbers and see how that affects your results.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>target_company</span> <span class=o>=</span> <span class=s1>&#39;[{&#34;CompanyName&#34;:&#34;Madeup Inc&#34;,&#34;State&#34;:&#34;NSW&#34;,&#34;Industry&#34;:&#34;Finance&#34;,&#34;Segment&#34;:&#34;Banking&#34;,&#34;Product 1 Name&#34;:&#34;Widget W&#34;,&#34;Product 1 Performance&#34;:85,&#34;Product 2 Name&#34;:&#34;&#34;,&#34;Product 2 Performance&#34;:&#34;&#34;,&#34;Product 3 Name&#34;:&#34;Widget Y&#34;,&#34;Product 3 Performance&#34;:74}]&#39;</span>
</span></span><span class=line><span class=cl><span class=n>company_data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>target_company</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>company_data</span><span class=p>[</span><span class=s1>&#39;State&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>company_data</span><span class=p>[</span><span class=s1>&#39;Industry&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>company_data</span><span class=p>[</span><span class=s1>&#39;Segment&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Query: </span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>For this code snippet, I have made up a target customer profile called <em>target_company</em>. This is a JSON string that represents the target customer full information, including individual product performance. I have used the <em>State</em>, <em>Industry</em> and <em>Segment</em> columns to create the target customer profile, which I have saved as <em>query</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>search_client</span> <span class=o>=</span> <span class=n>SearchClient</span><span class=p>(</span><span class=n>endpoint</span><span class=p>,</span> <span class=n>index_name</span><span class=p>,</span> <span class=n>credential</span><span class=o>=</span><span class=n>credential</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>vector_query</span> <span class=o>=</span> <span class=n>VectorizableTextQuery</span><span class=p>(</span><span class=n>text</span><span class=o>=</span><span class=n>query</span><span class=p>,</span> <span class=n>k_nearest_neighbors</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=s2>&#34;prof_vector&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>search_client</span><span class=o>.</span><span class=n>search</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>    <span class=n>search_text</span><span class=o>=</span><span class=n>query</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=c1>#vector_queries= [vector_query],</span>
</span></span><span class=line><span class=cl>    <span class=n>select</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;CompanyName&#34;</span><span class=p>,</span> <span class=s2>&#34;prof&#34;</span><span class=p>,</span> <span class=s2>&#34;performance&#34;</span><span class=p>,</span> <span class=s2>&#34;json&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nb>filter</span><span class=o>=</span><span class=s2>&#34;performance ge 60&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>top</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>include_total_count</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=p>(</span><span class=s1>&#39;Total Documents Matching Query:&#39;</span><span class=p>,</span> <span class=n>results</span><span class=o>.</span><span class=n>get_count</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-&#34;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>comp_profiles</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Score: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;@search.score&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CompanyName: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;CompanyName&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;profile: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;prof&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;performance: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;json: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;json&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>comp_profiles</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;json&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-&#34;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>  
</span></span></code></pre></td></tr></table></div></div><p>Now if you look at the code above, I have created a search client and I am only using the <em>search_text</em> parameter, which means I am doing a full text search. I have also commented out the <em>vector_queries</em> parameter, which means I am not doing a vector search (but we can add it in right after this).</p><blockquote><p>Now I have added the line <em>filter=&ldquo;performance ge 60&rdquo;</em> to filter out any search results that do not have high product performance. This is because later in the code I want to make recommendations based on the high performing products of the customer. This is by no means a perfect solution, but it&rsquo;s a simple way to filter out low performing products.</p></blockquote><p>Which produces the below results, which I have truncated for brevity;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Query: NSW Finance Banking
</span></span><span class=line><span class=cl>Total Documents Matching Query: <span class=m>404</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 13.586723
</span></span><span class=line><span class=cl>CompanyName: Sky Robotics
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 61.25
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Sky Robotics&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:75.0,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:87.0,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:21.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:62.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 13.586723
</span></span><span class=line><span class=cl>CompanyName: Consulting Apex
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 61.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Consulting Apex&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:58.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:81.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:56.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:49.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 13.266863
</span></span><span class=line><span class=cl>CompanyName: Orion Consulting
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 65.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Orion Consulting&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:null,<span class=s2>&#34;Product 4 Performance&#34;</span>:null,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:64.0,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:66.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 12.660498
</span></span><span class=line><span class=cl>CompanyName: Dynamics Arcadia
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 67.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Dynamics Arcadia&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:49.0,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:90.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:62.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 12.314001
</span></span><span class=line><span class=cl>CompanyName: Nexus Hyper
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 68.8333333333
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Nexus Hyper&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:49.0,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:85.0,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:92.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:15.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:93.0,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:79.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>And as you can see, all of the top 5 results also have a profile of <em>NSW Finance Banking</em> and have a performance of over 60. And if we look at the bottom 3 matches (matched 18-20), they have veered off the profile a little bit, but you can see are still related to the target profile. This is a good sign that the search index is working as expected.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Score: 9.345702
</span></span><span class=line><span class=cl>CompanyName: Octogon Craft
</span></span><span class=line><span class=cl>profile: SA Finance Banking
</span></span><span class=line><span class=cl>performance: 79.4
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Octogon Craft&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;SA&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:87.0,<span class=s2>&#34;Product 5 Name&#34;</span>:<span class=s2>&#34;Gizmo A&#34;</span>,<span class=s2>&#34;Product 5 Performance&#34;</span>:68.0,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:94.0,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:85.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:63.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 9.345702
</span></span><span class=line><span class=cl>CompanyName: Sea Communications
</span></span><span class=line><span class=cl>profile: VIC Finance Banking
</span></span><span class=line><span class=cl>performance: 69.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Sea Communications&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;VIC&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:93.0,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:78.0,<span class=s2>&#34;Product 4 Name&#34;</span>:null,<span class=s2>&#34;Product 4 Performance&#34;</span>:null,<span class=s2>&#34;Product 5 Name&#34;</span>:<span class=s2>&#34;Gizmo A&#34;</span>,<span class=s2>&#34;Product 5 Performance&#34;</span>:92.0,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:13.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 9.345702
</span></span><span class=line><span class=cl>CompanyName: Square Dynamics
</span></span><span class=line><span class=cl>profile: VIC Finance Banking
</span></span><span class=line><span class=cl>performance: 63.25
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Square Dynamics&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;VIC&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:33.0,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:83.0,<span class=s2>&#34;Product 4 Name&#34;</span>:null,<span class=s2>&#34;Product 4 Performance&#34;</span>:null,<span class=s2>&#34;Product 5 Name&#34;</span>:<span class=s2>&#34;Gizmo A&#34;</span>,<span class=s2>&#34;Product 5 Performance&#34;</span>:43.0,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:94.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span></code></pre></td></tr></table></div></div><p>Now lets look at the vector search results &#x1f604; but remember to uncomment the <em>vector_queries</em> parameter in the search client and comment out the <em>search_text</em> parameter. It should look like this;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>search_client</span><span class=o>.</span><span class=n>search</span><span class=p>(</span>  
</span></span><span class=line><span class=cl>    <span class=c1>#search_text=query,  </span>
</span></span><span class=line><span class=cl>    <span class=n>vector_queries</span><span class=o>=</span> <span class=p>[</span><span class=n>vector_query</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>select</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;CompanyName&#34;</span><span class=p>,</span> <span class=s2>&#34;prof&#34;</span><span class=p>,</span> <span class=s2>&#34;performance&#34;</span><span class=p>,</span> <span class=s2>&#34;json&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nb>filter</span><span class=o>=</span><span class=s2>&#34;performance ge 60&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>top</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>include_total_count</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  
</span></span></code></pre></td></tr></table></div></div><p>And the results should look like this;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Query: NSW Finance Banking
</span></span><span class=line><span class=cl>Total Documents Matching Query: <span class=m>50</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.9999994
</span></span><span class=line><span class=cl>CompanyName: Sky Robotics
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 61.25
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Sky Robotics&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:75.0,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:87.0,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:21.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:62.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.9999994
</span></span><span class=line><span class=cl>CompanyName: Consulting Apex
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 61.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Consulting Apex&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:58.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:81.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:56.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:49.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.9999994
</span></span><span class=line><span class=cl>CompanyName: Dynamics Arcadia
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 67.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Dynamics Arcadia&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:49.0,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:90.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:62.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.9999994
</span></span><span class=line><span class=cl>CompanyName: Nexus Hyper
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 68.8333333333
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Nexus Hyper&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:49.0,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:85.0,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:92.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:15.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:93.0,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:79.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.9999994
</span></span><span class=line><span class=cl>CompanyName: Orion Consulting
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 65.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Orion Consulting&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:null,<span class=s2>&#34;Product 4 Performance&#34;</span>:null,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:64.0,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:66.0<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>And as you can see, the results are the same as the full text search results, just in a slight different order, as all of the vectors match with a score of 0.9999994. This is a good sign that the vector search is working as expected.</p><p>Now lets look at the bottom 3 matches (matched 18-20) and see how they compare to the full text search results.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Score: 0.8401246
</span></span><span class=line><span class=cl>CompanyName: Innovations Strategies
</span></span><span class=line><span class=cl>profile: NSW Finance Software
</span></span><span class=line><span class=cl>performance: 60.1666666667
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Innovations Strategies&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Software&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:85.0,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:31.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:27.0,<span class=s2>&#34;Product 5 Name&#34;</span>:<span class=s2>&#34;Gizmo A&#34;</span>,<span class=s2>&#34;Product 5 Performance&#34;</span>:76.0,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:70.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:72.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.8401246
</span></span><span class=line><span class=cl>CompanyName: Moon Force
</span></span><span class=line><span class=cl>profile: NSW Finance Software
</span></span><span class=line><span class=cl>performance: 61.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Moon Force&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Software&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:null,<span class=s2>&#34;Product 4 Performance&#34;</span>:null,<span class=s2>&#34;Product 5 Name&#34;</span>:<span class=s2>&#34;Gizmo A&#34;</span>,<span class=s2>&#34;Product 5 Performance&#34;</span>:75.0,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:33.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:75.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.8401246
</span></span><span class=line><span class=cl>CompanyName: Aether Consulting
</span></span><span class=line><span class=cl>profile: NSW Finance Software
</span></span><span class=line><span class=cl>performance: 61.5
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Aether Consulting&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Software&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:92.0,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:40.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:70.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:44.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span></code></pre></td></tr></table></div></div><p>And as you can see, the bottom 3 matches are still related to the target profile, but are different to the full text search results.</p><p>Lastly, lets look at hybrid search results. To do this, you will need to uncomment the <em>vector_queries</em> parameter in the search client and the <em>search_text</em> parameter. And the results should look like this;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Query: NSW Finance Banking
</span></span><span class=line><span class=cl>Total Documents Matching Query: <span class=m>404</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.03333333507180214
</span></span><span class=line><span class=cl>CompanyName: Sky Robotics
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 61.25
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Sky Robotics&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:75.0,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:87.0,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:21.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:62.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.032786883413791656
</span></span><span class=line><span class=cl>CompanyName: Consulting Apex
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 61.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Consulting Apex&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:58.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:81.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:56.0,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:49.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.0320020467042923
</span></span><span class=line><span class=cl>CompanyName: Dynamics Arcadia
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 67.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Dynamics Arcadia&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:49.0,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:90.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:null,<span class=s2>&#34;Product 6 Performance&#34;</span>:null,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:62.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.0317540317773819
</span></span><span class=line><span class=cl>CompanyName: Orion Consulting
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 65.0
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Orion Consulting&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:null,<span class=s2>&#34;Product 1 Performance&#34;</span>:null,<span class=s2>&#34;Product 2 Name&#34;</span>:null,<span class=s2>&#34;Product 2 Performance&#34;</span>:null,<span class=s2>&#34;Product 3 Name&#34;</span>:null,<span class=s2>&#34;Product 3 Performance&#34;</span>:null,<span class=s2>&#34;Product 4 Name&#34;</span>:null,<span class=s2>&#34;Product 4 Performance&#34;</span>:null,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:64.0,<span class=s2>&#34;Product 7 Name&#34;</span>:null,<span class=s2>&#34;Product 7 Performance&#34;</span>:null,<span class=s2>&#34;Product 8 Name&#34;</span>:<span class=s2>&#34;Gizmo D&#34;</span>,<span class=s2>&#34;Product 8 Performance&#34;</span>:66.0<span class=o>}</span>
</span></span><span class=line><span class=cl>--------------------------------------------------
</span></span><span class=line><span class=cl>Score: 0.0314980149269104
</span></span><span class=line><span class=cl>CompanyName: Nexus Hyper
</span></span><span class=line><span class=cl>profile: NSW Finance Banking
</span></span><span class=line><span class=cl>performance: 68.8333333333
</span></span><span class=line><span class=cl>json: <span class=o>{</span><span class=s2>&#34;CompanyName&#34;</span>:<span class=s2>&#34;Nexus Hyper&#34;</span>,<span class=s2>&#34;State&#34;</span>:<span class=s2>&#34;NSW&#34;</span>,<span class=s2>&#34;Industry&#34;</span>:<span class=s2>&#34;Finance&#34;</span>,<span class=s2>&#34;Segment&#34;</span>:<span class=s2>&#34;Banking&#34;</span>,<span class=s2>&#34;Product 1 Name&#34;</span>:<span class=s2>&#34;Widget W&#34;</span>,<span class=s2>&#34;Product 1 Performance&#34;</span>:49.0,<span class=s2>&#34;Product 2 Name&#34;</span>:<span class=s2>&#34;Widget X&#34;</span>,<span class=s2>&#34;Product 2 Performance&#34;</span>:85.0,<span class=s2>&#34;Product 3 Name&#34;</span>:<span class=s2>&#34;Widget Y&#34;</span>,<span class=s2>&#34;Product 3 Performance&#34;</span>:92.0,<span class=s2>&#34;Product 4 Name&#34;</span>:<span class=s2>&#34;Widget Z&#34;</span>,<span class=s2>&#34;Product 4 Performance&#34;</span>:15.0,<span class=s2>&#34;Product 5 Name&#34;</span>:null,<span class=s2>&#34;Product 5 Performance&#34;</span>:null,<span class=s2>&#34;Product 6 Name&#34;</span>:<span class=s2>&#34;Gizmo B&#34;</span>,<span class=s2>&#34;Product 6 Performance&#34;</span>:93.0,<span class=s2>&#34;Product 7 Name&#34;</span>:<span class=s2>&#34;Gizmo C&#34;</span>,<span class=s2>&#34;Product 7 Performance&#34;</span>:79.0,<span class=s2>&#34;Product 8 Name&#34;</span>:null,<span class=s2>&#34;Product 8 Performance&#34;</span>:null<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>As you can see all of the usual suspects are there, but the scores are different. This is because the hybrid search is using both the full text search and the vector search to return the results. This is a good sign that the hybrid search is working as expected.</p><blockquote><p>As you can see for our use case, it doesn&rsquo;t really matter which search type we use, as they all return very similar results. But for your use case, you might find that one search type is better than the other.</p></blockquote><h2 id=make-recommendations-using-azure-open-ai>Make recommendations using Azure Open AI</h2><p>Now we are finally at the last part of the notebook. This part of the code will use Azure Open AI to make recommendations based on the high performing products of the customer. In the code above, as part of the print the results to output, we filled up an array called <em>comp_profiles</em> with the JSON strings of the top 20 similar customer profiles. We will use this array to make recommendations.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>### Create AOAI Client ###</span>
</span></span><span class=line><span class=cl><span class=n>chat_client</span> <span class=o>=</span> <span class=n>AzureOpenAI</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>api_key</span> <span class=o>=</span> <span class=n>azure_openai_key</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>api_version</span><span class=o>=</span><span class=n>azure_openai_api_version</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>azure_endpoint</span> <span class=o>=</span> <span class=n>azure_openai_endpoint</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Prepare the message content with the company profiles</span>
</span></span><span class=line><span class=cl><span class=n>message_content</span> <span class=o>=</span> <span class=s2>&#34;You are an assistant that recommends products to companies.</span><span class=se>\n</span><span class=s2>You will receive a company profile and you need to recommend the next product that the company should buy.</span><span class=se>\n</span><span class=s2>Below are some examples of similar companies and their products. Use the below to recommend the next products that the company should buy.</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>profile</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>comp_profiles</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>message_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;### Company </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=se>\n</span><span class=si>{</span><span class=n>profile</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message_content</span> <span class=o>+=</span> <span class=s2>&#34;Recommend the next product that the company should buy using data exclusively from the above text. Take a step-by-step approach in your response, cite product performance examples from the provided data and give reasoning before sharing final answer.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Send a chat call to generate an answer</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>chat_client</span><span class=o>.</span><span class=n>chat</span><span class=o>.</span><span class=n>completions</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>=</span><span class=n>azure_openai_chat_deployment</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>message_content</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>target_company</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>message</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>The things that has the most impact on the recommendations are the <em>message_content</em> and the <em>target_company</em>. The <em>message_content</em> is the system message where we are telling the Azure Open AI model what we want it to do. I have tried to use some good prompt engineering techniques including System message, Start with clear instructions, Repeat instructions at the end, Chain of thought prompting and Provide grounding context to get the best results. All of these techniques and more are explained in more detail <a class=link href="https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions" target=_blank rel=noopener>here</a>.</p><p>The way that this piece of code connects to the previous pieces is that I am adding in those top 20 search results from our search index to the <em>message_content</em>. So I have given the Azure Open AI model some context to work with.</p><p>And this is the response I got from the Azure Open AI model;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>To recommend the next product Madeup Inc should buy, let<span class=s1>&#39;s analyze the data and consider the following factors:
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>1. **Current Products and Performance**:
</span></span></span><span class=line><span class=cl><span class=s1>    - Madeup Inc already has &#34;Widget W&#34; with a performance of 85.
</span></span></span><span class=line><span class=cl><span class=s1>    - They also have &#34;Widget Y&#34; with a performance of 74.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>2. **Identify High-Performing Products in Similar Companies**:
</span></span></span><span class=line><span class=cl><span class=s1>    - For companies in the same industry, segment, and state (NSW, Finance, Banking), we can look at the highly performing products:
</span></span></span><span class=line><span class=cl><span class=s1>        - **&#34;Widget Z&#34;** has high performance across various companies:
</span></span></span><span class=line><span class=cl><span class=s1>            - Example: Sky Robotics: &#34;Widget Z&#34; (21); Dynamics Arcadia: &#34;Widget Z&#34; (90); Nexus Hyper: &#34;Widget Z&#34; (15); Consulting Apex: &#34;Widget Z&#34; (81); - with higher performance of 81 to 90
</span></span></span><span class=line><span class=cl><span class=s1>        - **&#34;Widget X&#34;** also shows high performance in companies where it&#39;</span>s being effectively utilized:
</span></span><span class=line><span class=cl>            - Example: Helix Industries: <span class=s2>&#34;Widget X&#34;</span> <span class=o>(</span>68<span class=o>)</span><span class=p>;</span> Communications Ignite: <span class=s2>&#34;Widget X&#34;</span> <span class=o>(</span>76<span class=o>)</span><span class=p>;</span> Sea Sphere: <span class=s2>&#34;Widget X&#34;</span> <span class=o>(</span>67<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. **Look <span class=k>for</span> Consistently High Performance or Complements**:
</span></span><span class=line><span class=cl>    - Based on the products already in use and their performance, adding a product with consistent high performance would benefit the overall system.
</span></span><span class=line><span class=cl>    - Considering the consistent performance of <span class=s2>&#34;Widget Z&#34;</span> around <span class=m>90</span> in both Nexus Hyper and Diamond Titanium suggests that this could be a viable next option.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Reasoning for Recommendation:</span>
</span></span><span class=line><span class=cl>1. **Widget Z** has shown high performance in similar companies:
</span></span><span class=line><span class=cl>    - For example, Dynamics Arcadia has <span class=s2>&#34;Widget Z&#34;</span> performing at 90, and Consulting Apex has it performing at 81. Given that <span class=s2>&#34;Widget Z&#34;</span> performs well in the same segment and industry, it is likely to complement the existing products of Madeup Inc.
</span></span><span class=line><span class=cl>2. **Widget X** also is a viable option based on performance ranges between <span class=m>67</span> to <span class=m>76</span> in companies with similar profiles and segments.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Final Recommendation:</span>
</span></span><span class=line><span class=cl>**Next Product: <span class=s2>&#34;Widget Z&#34;</span>**
</span></span><span class=line><span class=cl>- **Reason:**
</span></span><span class=line><span class=cl>    - High performance in multiple similar companies within the same segment and industry.
</span></span><span class=line><span class=cl>    - Complements the existing high-performance products already in use by Madeup Inc.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>By choosing <span class=s2>&#34;Widget Z,&#34;</span> Madeup Inc is likely to enhance its system efficiency and overall performance.
</span></span></code></pre></td></tr></table></div></div><p>And as you can see, the Azure Open AI model has done a good job at making recommendations based on the high performing products of the customer. It has also given a good reasoning for the recommendation and has cited product performance examples from the provided data. It looks like it was a close race between <em>Widget Z</em> and <em>Widget X</em>, but <em>Widget Z</em> won out in the end.</p><p>I do like the way that that Azure Open AI 4o has laid out it&rsquo;s reasoning and final recommendation. It&rsquo;s a good way to present the information to the user.</p><p>Also one of the interesting things with generative ai is that you can run the same code multiple times and get different results, like below;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>To recommend the next product that <span class=s2>&#34;Madeup Inc&#34;</span> should buy, we<span class=s1>&#39;ll consider the provided data and performance metrics for similar companies in the same segment (Banking) and geographical region (NSW). Here are the steps we will take:
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>### Step 1: Identify Relevant Companies
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>We&#39;</span>ll focus on companies in the banking segment within NSW that have similar product usage. Relevant companies include:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. **Sky Robotics**
</span></span><span class=line><span class=cl>2. **Consulting Apex**
</span></span><span class=line><span class=cl>3. **Dynamics Arcadia**
</span></span><span class=line><span class=cl>4. **Nexus Hyper**
</span></span><span class=line><span class=cl>5. **Diamond Titanium**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Step 2: Analyze Product Performance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>We<span class=err>&#39;</span>ll evaluate the performance of products used by these companies to identify the next suitable product <span class=k>for</span> Madeup Inc.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. **Widget X:**
</span></span><span class=line><span class=cl>   - Sky Robotics: 87.0
</span></span><span class=line><span class=cl>   - Nexus Hyper: 85.0
</span></span><span class=line><span class=cl>   - Hexagon Ignite: 94.0
</span></span><span class=line><span class=cl>   - Consulting Apex: 58.0
</span></span><span class=line><span class=cl>   - Diamond Titanium: <span class=o>(</span>No Data<span class=o>)</span>
</span></span><span class=line><span class=cl>   - **Average Performance: <span class=o>(</span>87+85+94+58<span class=o>)</span>/4 <span class=o>=</span> 81.0**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. **Widget Z:**
</span></span><span class=line><span class=cl>   - Sky Robotics: 21.0
</span></span><span class=line><span class=cl>   - Dynamics Arcadia: 90.0
</span></span><span class=line><span class=cl>   - Nexus Hyper: 15.0
</span></span><span class=line><span class=cl>   - Consulting Apex: 81.0
</span></span><span class=line><span class=cl>   - Diamond Titanium: 87.0
</span></span><span class=line><span class=cl>   - **Average Performance: <span class=o>(</span>21+90+15+81+87<span class=o>)</span>/5 <span class=o>=</span> 58.8**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. **Gizmo D:**
</span></span><span class=line><span class=cl>   - Sky Robotics: 62.0
</span></span><span class=line><span class=cl>   - Consulting Apex: 49.0
</span></span><span class=line><span class=cl>   - Dynamics Arcadia: <span class=o>(</span>No Data<span class=o>)</span>
</span></span><span class=line><span class=cl>   - Nexus Hyper: <span class=o>(</span>No Data<span class=o>)</span>
</span></span><span class=line><span class=cl>   - Diamond Titanium: <span class=o>(</span>No Data<span class=o>)</span>
</span></span><span class=line><span class=cl>   - **Average Performance: <span class=o>(</span>62+49<span class=o>)</span>/2 <span class=o>=</span> 55.5**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. **Gizmo C:**
</span></span><span class=line><span class=cl>   - Dynamics Arcadia: 62.0
</span></span><span class=line><span class=cl>   - Nexus Hyper: 79.0
</span></span><span class=line><span class=cl>   - Consulting Apex: 56.0
</span></span><span class=line><span class=cl>   - Diamond Titanium: <span class=o>(</span>No Data<span class=o>)</span>
</span></span><span class=line><span class=cl>   - **Average Performance: <span class=o>(</span>62+79+56<span class=o>)</span>/3 <span class=o>=</span> 65.7**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Step 3: Determine the Best Next Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Since Madeup Inc is in the banking segment within NSW and has used Widget W and Widget Y with reasonable performance:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- Widget W: 85.0
</span></span><span class=line><span class=cl>- Widget Y: 74.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The statistics show that **Widget X** is the next best-performing product with a consistent high average performance of around **81.0**.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Recommendation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>**Widget X** is the most suitable next product <span class=k>for</span> Madeup Inc, considering its high average performance across similar banking companies in NSW, and its successful track record in similar companies.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>**Final Answer: Widget X**
</span></span></code></pre></td></tr></table></div></div><p>I really like the second response more then the first. So my next job will be to try and get a repeatable response I am happy with from Azure Open AI model.</p><p>So I have changed the second half of my prompt to be <em>&ldquo;Recommend the next product that the company should buy using data exclusively from the above text. You process should involve a step-by-step approach, which the following steps: 1. Analyze the company profile, 2. Identify Relevant Companies, 3. Calculate Average Performance, 4. Recommend two products a primary and secondary, 5. Justify primary and secondary Recommendations.&rdquo;</em></p><p>The major changes I have made is to swap out the chain of thought technique for a break the task down technique. I have also added in a secondary recommendation, as I think that is a good idea. Lastly I added in a step to calculate the average performance of the products, to give more justification to the recommendations.</p><p>And this is the response I got from the Azure Open AI model;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>To recommend the next product <span class=k>for</span> Madeup Inc, I<span class=s1>&#39;ll follow the outlined steps.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>### Step 1: Analyze the company profile
</span></span></span><span class=line><span class=cl><span class=s1>**Company Name:** Madeup Inc  
</span></span></span><span class=line><span class=cl><span class=s1>**Location:** NSW  
</span></span></span><span class=line><span class=cl><span class=s1>**Industry:** Finance  
</span></span></span><span class=line><span class=cl><span class=s1>**Segment:** Banking  
</span></span></span><span class=line><span class=cl><span class=s1>**Current Products and Performance:**
</span></span></span><span class=line><span class=cl><span class=s1>- **Widget W:** 85.0
</span></span></span><span class=line><span class=cl><span class=s1>- **Widget Y:** 74.0
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>### Step 2: Identify Relevant Companies
</span></span></span><span class=line><span class=cl><span class=s1>Since Madeup Inc is in the Finance industry, Banking segment, located in NSW, I&#39;</span>ll look <span class=k>for</span> other NSW-based Banking companies within the dataset.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Relevant companies:
</span></span><span class=line><span class=cl>1. Sky Robotics
</span></span><span class=line><span class=cl>2. Consulting Apex
</span></span><span class=line><span class=cl>3. Nexus Hyper
</span></span><span class=line><span class=cl>4. Diamond Titanium
</span></span><span class=line><span class=cl>5. Dynamics Arcadia
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Step 3: Calculate Average Performance</span>
</span></span><span class=line><span class=cl>Among the relevant companies, assess the performance of the products they use:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#### Widget X</span>
</span></span><span class=line><span class=cl>- Sky Robotics: 87.0
</span></span><span class=line><span class=cl>- Nexus Hyper: 85.0
</span></span><span class=line><span class=cl>- Average: <span class=o>(</span>87.0 + 85.0<span class=o>)</span> / <span class=nv>2</span> <span class=o>=</span> 86.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#### Widget Z</span>
</span></span><span class=line><span class=cl>- Sky Robotics: 21.0
</span></span><span class=line><span class=cl>- Consulting Apex: 81.0
</span></span><span class=line><span class=cl>- Nexus Hyper: 15.0
</span></span><span class=line><span class=cl>- Dynamics Arcadia: 90.0
</span></span><span class=line><span class=cl>- Diamond Titanium: 87.0
</span></span><span class=line><span class=cl>- Average: <span class=o>(</span>21.0 + 81.0 + 15.0 + 90.0 + 87.0<span class=o>)</span> / <span class=nv>5</span> <span class=o>=</span> 58.8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#### Gizmo B</span>
</span></span><span class=line><span class=cl>- Nexus Hyper: 93.0
</span></span><span class=line><span class=cl>- Diamond Titanium: 67.0
</span></span><span class=line><span class=cl>- Average: <span class=o>(</span>93.0 + 67.0<span class=o>)</span> / <span class=nv>2</span> <span class=o>=</span> 80.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#### Gizmo C</span>
</span></span><span class=line><span class=cl>- Nexus Hyper: 79.0
</span></span><span class=line><span class=cl>- Dynamics Arcadia: 62.0
</span></span><span class=line><span class=cl>- Consulting Apex: 56.0
</span></span><span class=line><span class=cl>- Average: <span class=o>(</span>79.0 + 62.0 + 56.0<span class=o>)</span> / <span class=nv>3</span> <span class=o>=</span> 65.7
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#### Gizmo D</span>
</span></span><span class=line><span class=cl>- Sky Robotics: 62.0
</span></span><span class=line><span class=cl>- Consulting Apex: 49.0
</span></span><span class=line><span class=cl>- Dynamics Arcadia: 0.0 <span class=o>(</span>absent<span class=o>)</span>
</span></span><span class=line><span class=cl>- Nexus Hyper: 0.0 <span class=o>(</span>absent<span class=o>)</span>
</span></span><span class=line><span class=cl>- Diamond Titanium: 0.0 <span class=o>(</span>absent<span class=o>)</span>
</span></span><span class=line><span class=cl>- Average: <span class=o>(</span>62.0 + 49.0<span class=o>)</span> / <span class=nv>2</span> <span class=o>=</span> 55.5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Step 4: Recommend Primary and Secondary Products</span>
</span></span><span class=line><span class=cl>**Primary Recommendation:** Widget X <span class=o>(</span>Average Performance: 86.0<span class=o>)</span>
</span></span><span class=line><span class=cl>**Secondary Recommendation:** Gizmo B <span class=o>(</span>Average Performance: 80.0<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Step 5: Justify Recommendations</span>
</span></span><span class=line><span class=cl>**Primary Recommendation: Widget X**
</span></span><span class=line><span class=cl>- **Reasoning:** Widget X shows a consistently high performance average <span class=o>(</span>86.0<span class=o>)</span> in relevant companies such as Sky Robotics and Nexus Hyper. The high average and strong performance suggest it is a reliable product <span class=k>for</span> achieving effective outcomes in the Banking segment within the Finance industry.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>**Secondary Recommendation: Gizmo B**
</span></span><span class=line><span class=cl>- **Reasoning:** Gizmo B also shows good performance with an average of 80.0, as seen in companies like Nexus Hyper and Diamond Titanium. This makes it a strong contender <span class=k>for</span> providing additional benefits and complementing the existing high performance of Widget W and Widget Y. 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hence, based on the performance data and relevance within the industry and geographical segment, Widget X and Gizmo B are the recommended next products <span class=k>for</span> Madeup Inc.
</span></span></code></pre></td></tr></table></div></div><p>I also ran the prompt again 5 more times (which we can do now we have setup our Azure environment) and got consistent results with Wiget X and Gizmo B always being recommended. So I am happy with the results.</p><h2 id=conclusion>Conclusion</h2><p>In this part two post, we have expanded our dataset and created a search index on Azure AI Search. We have also queried the search index using full text search, vector search and hybrid search and We have also made recommendations using Azure Open AI.</p><p>I hope you have found this post useful and that it has inspired you to build your own Gen AI Product Recommendation System. If you have any questions or comments, please feel free to leave them below. I would love to hear from you.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/azure-open-ai/>Azure Open AI</a>
<a href=/tags/python/>Python</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/simple-gen-ai-product-recommendation-system-you-can-poc-quickly/><div class=article-image><img src=/p/simple-gen-ai-product-recommendation-system-you-can-poc-quickly/cover.bc1a769b2bf354d8a87d51397f8da7fc_hu16783130262988169499.jpg width=250 height=150 loading=lazy alt="Featured image of post Simple Gen AI Product Recommendation System you can POC quickly" data-hash="md5-vBp2myvzVNiofVE5f42n/A=="></div><div class=article-details><h2 class=article-title>Simple Gen AI Product Recommendation System you can POC quickly</h2></div></a></article><article class=has-image><a href=/p/automated-document-processing-and-fraud-detection-with-azure/><div class=article-image><img src=/p/automated-document-processing-and-fraud-detection-with-azure/cover.8031a5ff034bbf5b0b3d687df799c87e_hu3040367034163266224.jpg width=250 height=150 loading=lazy alt="Featured image of post Automated document processing and fraud detection with Azure" data-hash="md5-gDGl/wNLv1sLPWh995nIfg=="></div><div class=article-details><h2 class=article-title>Automated document processing and fraud detection with Azure</h2></div></a></article><article class=has-image><a href=/p/azure-open-ai-increase-performance-and-reduce-per-call-latency/><div class=article-image><img src=/p/azure-open-ai-increase-performance-and-reduce-per-call-latency/cover.ed3425a2f23159a428dd8655f302d1ee_hu7479023586228177266.jpg width=250 height=150 loading=lazy alt="Featured image of post Azure Open AI - Increase Performance and reduce per call latency" data-hash="md5-7TQlovIxWaQo3YZV8wLR7g=="></div><div class=article-details><h2 class=article-title>Azure Open AI - Increase Performance and reduce per call latency</h2></div></a></article><article class=has-image><a href=/p/ai-generated-azure-news-summary/><div class=article-image><img src=/p/ai-generated-azure-news-summary/cover.64db9f55634ff34eaf2d4d2cb156527c_hu3456839047031088951.jpg width=250 height=150 loading=lazy alt="Featured image of post AI Generated Azure News Summary" data-hash="md5-ZNufVWNP806vLU0ssVZSfA=="></div><div class=article-details><h2 class=article-title>AI Generated Azure News Summary</h2></div></a></article><article class=has-image><a href=/p/using-ssml-with-azure-ai-speech-service/><div class=article-image><img src=/p/using-ssml-with-azure-ai-speech-service/cover.dff5bfee24dd220ed43e30f71e5d8ff0_hu6794696554352319624.jpeg width=250 height=150 loading=lazy alt="Featured image of post Using SSML with Azure AI Speech service" data-hash="md5-3/W/7iTdIg7UPjD3Hl2P8A=="></div><div class=article-details><h2 class=article-title>Using SSML with Azure AI Speech service</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=fredderf204/mfblog4-giscus data-repo-id=R_kgDOK5HFPw data-category=Announcements data-category-id=DIC_kwDOK5HFP84Cbspg data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 MF Azure Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>